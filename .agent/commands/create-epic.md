# /create-epic

PRDから実装計画（Epic）を作成するコマンド。

## 使用方法

```
/create-epic [PRDファイル名]
```

## 実行フロー

### Phase 1: PRD読み込み

1. 指定されたPRDファイルを読み込み
2. PRDの完成チェックリストを再確認
3. Q6のUnknown項目を抽出

### Phase 2: Unknown項目の解消

PRDのQ6でUnknownだった項目について確認質問：

```
PRDで以下の項目がUnknownでした。Epicを作成する前に確認させてください。

1. [項目名]: [選択肢]を選んでください
2. [項目名]: [選択肢]を選んでください
```

### Phase 3: 技術方針の確認

PRDの「規模感」と「技術方針」を確認し、制限を適用：

**シンプル優先の制限:**

- 外部サービス数: 最大1
- 新規導入ライブラリ: 最大3
- 新規コンポーネント数: 最大3
- 非同期基盤: 禁止
- マイクロサービス分割: 禁止
- コンテナオーケストレーション: 禁止

**バランスの制限:**

- 外部サービス数: 最大3
- 新規導入ライブラリ: 最大5
- 新規コンポーネント数: 最大5
- 非同期基盤: 使う場合は理由を明記
- マイクロサービス分割: する場合は理由を明記

### Phase 4: 必須提出物（3一覧）の作成

以下の3つの表を**必ず**作成：

#### 外部サービス一覧

外部サービス-1
名称: [ここに記載]
用途: [ここに記載]
必須理由: [ここに記載]
代替案: [ここに記載]

#### コンポーネント一覧

コンポーネント-1
名称: [ここに記載]
責務: [ここに記載]
デプロイ形態: [ここに記載]

#### 新規技術一覧

新規技術-1
名称: [ここに記載]
カテゴリ: [ここに記載]
既存との差: [ここに記載]
導入理由: [ここに記載]

### Phase 5: カウント定義の適用

- 外部サービス数
  - 定義: ネットワーク越しに依存する別管理のサービス
  - カウント単位: SaaS、マネージドDB、認証基盤、外部API を各1
- コンポーネント数
  - 定義: デプロイ単位
  - カウント単位: 別プロセス、別ジョブ、別ワーカー、別バッチ を各1
- 新規技術
  - 定義: 新規に導入する主要技術カテゴリ
  - カウント単位: DB、キュー、認証、観測基盤、フレームワーク、クラウドサービス を各1

### Phase 6: 代替案の提示

単純な代替案がある場合は**必ず両方提示**：

```
## 技術選定: データベース

### 案A（推奨）: PostgreSQL
- 理由: [理由]
- メリット: [メリット]
- デメリット: [デメリット]

### 案B: SQLite
- 理由: [理由]
- メリット: [メリット]
- デメリット: [デメリット]

### 選択
→ 案Aを採用。理由: [選択理由]
```

### Phase 7: Issue分割案の作成

`.agent/rules/issue.md` のルールに従って分割：

- 変更行数: 50〜300行
- 変更ファイル数: 1〜5ファイル
- AC数: 2〜5個

### Phase 8: チェックリスト検証

```
□ 新規技術/サービス名が5つ以下
□ 新規コンポーネント数が上限以内
□ 各選択に「なぜこれを選んだか」の理由がある
□ 代替案（よりシンプルな方法）が提示されている
□ 「将来のため」だけを理由にした項目がない
□ 必須提出物（外部サービス一覧/コンポーネント一覧/新規技術一覧）が揃っている
```

### Phase 9: Epic生成

1. `docs/epics/_template.md` をコピー
2. 収集した情報を埋め込み
3. `docs/epics/[PRD名]-epic.md` として保存

## 出力ファイル

```
docs/epics/[PRD名]-epic.md
```

## 禁止事項

- 「将来の拡張性」だけを理由にした複雑化
- シンプル優先時のマイクロサービス提案
- 必須提出物（外部サービス一覧/コンポーネント一覧/新規技術一覧）の省略
- 代替案なしでの技術選定

## 関連ルール

- `.agent/rules/epic.md` - Epic生成ルール（カウント定義、許可/禁止リスト）
- `.agent/rules/issue.md` - Issue粒度規約
- `.agent/rules/docs-sync.md` - ドキュメント同期ルール

## 次のコマンド

Epic完成後は `/create-issues` を実行してIssueを作成する。
